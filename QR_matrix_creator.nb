(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     14654,        364]
NotebookOptionsPosition[     13673,        343]
NotebookOutlinePosition[     14133,        360]
CellTagsIndexPosition[     14090,        357]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[TextData[{
 StyleBox["QR Matrix Creator",
  FontFamily->"Arial",
  FontWeight->"Bold",
  FontVariations->{"Underline"->True}],
 ":\n",
 StyleBox["Description",
  FontSlant->"Italic"],
 ": Script for generating an orthogonal matrix, ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["Q", "TI"], TraditionalForm], "errors" -> {}, "input" -> "Q", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "48e2fa4a-c081-48f8-96a7-765fa8da892f"],
 ", upper-triangular matrix ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["R", "TI"], TraditionalForm], "errors" -> {}, "input" -> "R", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "448a90fc-f113-48b5-82ce-7d2f2cd6b381"],
 ", and integer matrix ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["A", "TI"], TraditionalForm], "errors" -> {}, "input" -> "A", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "9307964f-cf70-4aa2-9ab2-38ecf283dda9"],
 " so that ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["A", "TI"], "\[LongEqual]", 
         StyleBox["Q", "TI"], 
         StyleBox["R", "TI"]}], TraditionalForm], "errors" -> {}, "input" -> 
     "A=QR", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "ddfdebb4-9646-4b0e-8ebf-9da12b56767b"],
 "\n",
 StyleBox["Authors: Ryan H. Allaire, Andrew Lee, and Margaret Reynolds",
  FontSlant->"Italic"]
}], "Text",
 CellChangeTimes->{{3.915894183401026*^9, 3.915894229798596*^9}, {
   3.915897315441089*^9, 3.9158973322993064`*^9}, {3.917018328369525*^9, 
   3.9170183289158525`*^9}, {3.917018359586009*^9, 3.917018371777697*^9}, 
   3.917018405342697*^9},ExpressionUUID->"774e792d-2028-429a-8c2b-\
f49a39076a38"],

Cell[TextData[{
 StyleBox["Step 1",
  FontWeight->"Bold"],
 ": \n",
 StyleBox["(i): Choose a vector ",
  FontSlant->"Italic"],
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         OverscriptBox[
          StyleBox["v", "TI"], "\[RightVector]"], "\[Element]", 
         SuperscriptBox[
          StyleBox["R", FontSlant -> "Plain"], 
          StyleBox["n", "TI"]]}], TraditionalForm], "errors" -> {}, "input" -> 
     "\\vec{v} \\in \\mathbb{R}^n", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "b25a05f2-df9f-44fa-b52f-079252c22217"],
 " that has integer components. Generate a non-identity orthogonal matrix ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["Q", "TI"], TraditionalForm], "errors" -> {}, "input" -> "Q", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "a88e555c-7c02-4602-94e3-e8688d92975b"],
 " via the Householder transformation ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["Q", "TI"], "\[LongEqual]", 
         StyleBox["I", "TI"], "-", "2", 
         OverscriptBox[
          StyleBox["v", "TI"], "\[RightVector]"], 
         SuperscriptBox[
          OverscriptBox[
           StyleBox["v", "TI"], "\[RightVector]"], 
          StyleBox["T", "TI"]], "/", "||", 
         OverscriptBox[
          StyleBox["v", "TI"], "\[RightVector]"], 
         SuperscriptBox["||", "2"]}], TraditionalForm], "errors" -> {}, 
     "input" -> "Q = I - 2\\vec{v} \\vec{v}^T/||\\vec{v}||^2", "state" -> 
     "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "0da72ff7-3771-4521-86cf-e6a52b83ce64"],
 ". The resultant matrix ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["Q", "TI"], TraditionalForm], "errors" -> {}, "input" -> "Q", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "88758f8f-8d8b-4816-97dd-cb09663056a3"],
 " will then be rational (possibly integer)."
}], "Text",
 CellChangeTimes->{{3.891029323443633*^9, 3.8910293439123845`*^9}, {
  3.891029692195823*^9, 3.891029714061166*^9}, {3.9158973374644785`*^9, 
  3.9158973936974177`*^9}, {3.915897443585575*^9, 3.915897618944627*^9}, {
  3.937906194817524*^9, 3.93790620690637*^9}, {3.937906277932053*^9, 
  3.937906324561249*^9}, {3.9379064751850147`*^9, 
  3.9379064756125603`*^9}},ExpressionUUID->"ef5dd686-3888-4e01-a8b6-\
50f9458e9093"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Choose", " ", "the", " ", "integer", " ", "vector", " ", "v"}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Choosing", " ", "||", "v", "||"}], "=", 
    RowBox[{
    "1", " ", "will", " ", "yield", " ", "integer", " ", "matrix", " ", 
     "A"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"v", "=", 
    RowBox[{"(", GridBox[{
       {"\[Placeholder]"},
       {"\[Placeholder]"},
       {"\[Placeholder]"}
      }], ")"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Generate", " ", "the", " ", "orthogonal", " ", "matrix"}], ",", 
    " ", "Q"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Q", " ", "=", " ", 
   RowBox[{
    RowBox[{"IdentityMatrix", "[", 
     RowBox[{"Length", "[", "v", "]"}], "]"}], "-", 
    RowBox[{"2", "*", 
     RowBox[{
      RowBox[{"v", ".", 
       RowBox[{"Transpose", "[", "v", "]"}]}], "/", 
      RowBox[{
       RowBox[{"Norm", "[", "v", "]"}], "^", "2"}]}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MatrixForm", "[", "Q", "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Alternative", ":", " ", 
    RowBox[{
    "use", " ", "\"\<ReflectionMatrix[Flatten[v]]\>\"", " ", "command"}]}], 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.891029266902852*^9, 3.891029320129628*^9}, {
   3.891029400914838*^9, 3.891029425749267*^9}, {3.891029794044487*^9, 
   3.8910298498981533`*^9}, {3.891029975751605*^9, 3.891029980244899*^9}, {
   3.891030696478292*^9, 3.8910307024696417`*^9}, {3.891030829538297*^9, 
   3.8910308386087523`*^9}, {3.914919929678213*^9, 3.914919943117157*^9}, {
   3.914920771133394*^9, 3.91492079494218*^9}, {3.91492085452698*^9, 
   3.914920877357914*^9}, {3.9149457556335325`*^9, 3.91494575966515*^9}, {
   3.914945806318483*^9, 3.914945865112638*^9}, {3.9149460975074434`*^9, 
   3.91494612538467*^9}, {3.914946166772185*^9, 3.914946179756052*^9}, {
   3.9149464660220547`*^9, 3.914946472684013*^9}, {3.914946526643826*^9, 
   3.914946532724484*^9}, {3.914948332191766*^9, 3.914948383086064*^9}, {
   3.914948435689832*^9, 3.914948442804476*^9}, {3.9149662469586697`*^9, 
   3.914966356041486*^9}, {3.9149667118892293`*^9, 3.914966719434215*^9}, {
   3.9152018700732164`*^9, 3.915201871923651*^9}, {3.915201934368687*^9, 
   3.915201938493759*^9}, {3.915202010719902*^9, 3.915202032169175*^9}, {
   3.915202749209644*^9, 3.915202781082883*^9}, {3.915202974400875*^9, 
   3.915203039680947*^9}, 3.915295175249256*^9, {3.9152952984622784`*^9, 
   3.915295328033449*^9}, {3.915295724798355*^9, 3.915295725998052*^9}, {
   3.915296087494241*^9, 3.915296091519764*^9}, {3.915296198769977*^9, 
   3.9152962135512743`*^9}, {3.91529639916155*^9, 3.915296399247717*^9}, {
   3.915296508337398*^9, 3.9152965161757317`*^9}, {3.9152979801604304`*^9, 
   3.915297983679984*^9}, {3.915298245137863*^9, 3.915298277854031*^9}, {
   3.91529885574424*^9, 3.915298859758748*^9}, {3.915298902736046*^9, 
   3.915298927470844*^9}, {3.9152993465288267`*^9, 3.9152993567672725`*^9}, {
   3.915299422548253*^9, 3.9152994312138176`*^9}, {3.91529957494404*^9, 
   3.9152995763984103`*^9}, {3.9153001356136026`*^9, 3.915300139692815*^9}, {
   3.9158976455680237`*^9, 3.91589772803208*^9}, 3.9170185051879435`*^9, {
   3.917018767570315*^9, 3.917018769859403*^9}, {3.9170188088186717`*^9, 
   3.9170188655548525`*^9}, {3.9170192092027793`*^9, 3.917019210449444*^9}, 
   3.917085377324808*^9, {3.917085607462694*^9, 3.917085610263117*^9}, {
   3.9370396963216305`*^9, 3.937039696953184*^9}, {3.9370398088408546`*^9, 
   3.937039833282437*^9}, {3.937039882020037*^9, 3.937039914473936*^9}, {
   3.9370399626837826`*^9, 3.9370400001520195`*^9}, {3.937040034322174*^9, 
   3.9370400707294*^9}, {3.937906264813448*^9, 3.937906270070961*^9}, {
   3.9379065007567677`*^9, 3.937906501308229*^9}, {3.937906540355362*^9, 
   3.9379065418751297`*^9}},ExpressionUUID->"61194921-82a2-4475-84d1-\
cb3e9ac758ba"],

Cell[TextData[{
 StyleBox["Step 2",
  FontWeight->"Bold"],
 ":",
 " Choose R\n(ii) : Choose  integers  for  an  upper  triangular  matrix, R"
}], "Text",
 CellChangeTimes->{{3.9379064785865307`*^9, 
  3.93790648872011*^9}},ExpressionUUID->"2e667dc2-9248-f343-a3db-\
4eda0a71af17"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Choose", " ", "the", " ", "upper", " ", "triangular", " ", "portion", " ",
     "of", " ", "R"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"R1", "=", " ", 
    RowBox[{"(", GridBox[{
       {"\[Placeholder]", "\[Placeholder]", "\[Placeholder]"},
       {"0", "\[Placeholder]", "\[Placeholder]"},
       {"0", "0", "\[Placeholder]"}
      }], ")"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.937906550093712*^9, 
  3.937906554645687*^9}},ExpressionUUID->"734cae41-9a8b-8246-8b50-\
d4c2b29a0e62"],

Cell[TextData[{
 StyleBox["Step 3",
  FontWeight->"Bold"],
 ": Construct A\n",
 StyleBox["(iii) Generate A via ",
  FontSlant->"Italic"],
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["A", "TI"], "\[LongEqual]", 
         StyleBox["Q", "TI"], 
         RowBox[{"(", 
           RowBox[{
             StyleBox["c", "TI"], 
             StyleBox["R", "TI"]}], ")"}]}], TraditionalForm], "errors" -> {},
      "input" -> "A =Q(cR)", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "5c851c19-12cc-6647-a7b9-659ae14c06a4"],
 " where ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["c", "TI"], TraditionalForm], "errors" -> {}, "input" -> "c", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "0ee75382-a5ff-be4f-b3e5-bf9fccdf1926"],
 " (the lcd of the components of ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["Q", "TI"], TraditionalForm], "errors" -> {}, "input" -> "Q", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "57863b0d-a6fe-9c4f-8c47-b60dfcc71c03"],
 ") is chosen to make ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["A", "TI"], TraditionalForm], "errors" -> {}, "input" -> "A", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "260d3a0a-b26e-3b4f-bb28-484c48a0016c"],
 " integer. "
}], "Text",
 CellChangeTimes->{{3.915897899440199*^9, 3.915897910921574*^9}, {
  3.9158980918416*^9, 3.915898139264563*^9}, {3.915898682704123*^9, 
  3.9158987161304398`*^9}, {3.937906378903977*^9, 
  3.9379064642754345`*^9}},ExpressionUUID->"1ba00c18-a6bb-48c4-87f0-\
1134bc750f41"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Simply", " ", "execute", " ", "cell", " ", "shift"}], "+", 
    "enter"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"c", "=", 
     RowBox[{"Max", "[", 
      RowBox[{"Denominator", "[", "Q", "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"R", "=", 
     RowBox[{"c", "*", "R1"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"A", " ", "=", " ", 
     RowBox[{"Q", ".", "R"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<A = \>\"", ",", 
     RowBox[{"MatrixForm", "[", "A", "]"}]}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<Q = \>\"", ",", 
     RowBox[{"MatrixForm", "[", "Q", "]"}]}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<R = \>\"", ",", 
     RowBox[{"MatrixForm", "[", "R", "]"}]}], "]"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<Check QR = \>\"", ",", 
     RowBox[{"MatrixForm", "[", 
      RowBox[{"Q", ".", "R"}], "]"}], ",", " ", "\"\<=A\>\""}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.891030997636633*^9, 3.891031043445504*^9}, {
  3.9158981942086453`*^9, 3.915898196806155*^9}, {3.915898287457495*^9, 
  3.9158983854114*^9}, {3.915898420849017*^9, 3.915898425024598*^9}, {
  3.915898470931473*^9, 3.9158984748656416`*^9}, {3.915898518448567*^9, 
  3.915898655860082*^9}, {3.9170192221944995`*^9, 3.917019251505079*^9}, {
  3.917085561277014*^9, 3.917085577988163*^9}, {3.9170856876058464`*^9, 
  3.91708568835083*^9}, {3.937040019716062*^9, 3.9370400573225956`*^9}, {
  3.9379064560882015`*^9, 
  3.9379064566357117`*^9}},ExpressionUUID->"0b1d235f-614e-46b1-ba7b-\
00139287f5d1"]
},
WindowSize->{1428, 735.75},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
TaggingRules-><|"TryRealOnly" -> False|>,
FrontEndVersion->"14.0 for Microsoft Windows (64-bit) (December 12, 2023)",
StyleDefinitions->"Creative/NaturalColor.nb",
ExpressionUUID->"6e525e56-a586-4fc2-a520-3b091f0130c6"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 1929, 51, 110, "Text",ExpressionUUID->"774e792d-2028-429a-8c2b-f49a39076a38"],
Cell[2490, 73, 2525, 62, 117, "Text",ExpressionUUID->"ef5dd686-3888-4e01-a8b6-50f9458e9093"],
Cell[5018, 137, 4157, 81, 374, "Input",ExpressionUUID->"61194921-82a2-4475-84d1-cb3e9ac758ba"],
Cell[9178, 220, 280, 8, 77, "Text",ExpressionUUID->"2e667dc2-9248-f343-a3db-4eda0a71af17"],
Cell[9461, 230, 570, 15, 140, "Input",ExpressionUUID->"734cae41-9a8b-8246-8b50-d4c2b29a0e62"],
Cell[10034, 247, 1808, 49, 79, "Text",ExpressionUUID->"1ba00c18-a6bb-48c4-87f0-1134bc750f41"],
Cell[11845, 298, 1824, 43, 318, "Input",ExpressionUUID->"0b1d235f-614e-46b1-ba7b-00139287f5d1"]
}
]
*)

